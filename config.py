"""
config.py
IMD Strategic Consulting - 멀티 페르소나 통합 설정
URL 파라미터로 분기: ?client=gs (안과), ?client=nana (성형), 기본(한의원)
"""

import streamlit as st

# ============================================
# URL 파라미터 읽기
# ============================================
try:
    query_params = st.query_params
    CLIENT_ID = query_params["client"]
except:
    CLIENT_ID = "oriental"

if isinstance(CLIENT_ID, list):
    CLIENT_ID = CLIENT_ID[0]

# ============================================
# 공통 디자인 컬러
# ============================================
COLOR_PRIMARY = "#111827"
COLOR_BG = "#FFFFFF"
COLOR_TEXT = "#111827"
COLOR_AI_BUBBLE = "#F9FAFB"
COLOR_USER_BUBBLE = "#E5E7EB"
COLOR_BORDER = "#E5E7EB"

# ============================================
# 병원별 데이터셋
# ============================================
DATA = {
    # ==========================================
    # 1. [기본] 한의원 (?client=oriental 또는 기본)
    # ==========================================
    "oriental": {
        "APP_TITLE": "IMD Strategic Consulting",
        "APP_ICON": "💼",
        "HEADER_TITLE": "IMD STRATEGIC CONSULTING",
        "HEADER_SUB": "원장님의 진료 철학을 완벽하게 학습한 'AI 수석 실장'을 소개합니다",
        "HEADER_SMALL": "엑셀은 기록만 하지만, AI는 '매출'을 만듭니다. (체험시간: 2분)",
        "INITIAL_MSG": """안녕하십니까, 원장님.

원장님, 오늘 "그냥 침만 맞을게요"라는 말, 몇 번이나 들으셨습니까?

그 한 마디에 날아간 매출이 이번 달에만 얼마인지 계산해 보셨나요?

환자가 진료실 문을 열기 전, 이미 결제할 마음을 먹게 만드는 것. 그게 제가 하는 일입니다.

저는 밥도 안 먹고, 퇴근도 안 하며, 감정 노동에 지치지도 않는 AI 세일즈 실장입니다.

지금 바로, 제가 악성 환자를 어떻게 'VIP'로 바꾸는지 대화 내역을 눈으로 확인하세요.""",
        "TONGUE_GUIDE": "거울을 보시고 본인의 혀와 가장 비슷한 사진을 선택해주세요",
        "CTA_TITLE": "이 시스템을 한의원에 도입하시겠습니까?",
        "CTA_SUB": "지역구 독점권은 선착순입니다. 무료 도입 견적서를 보내드립니다",
        "FORM_LABEL_1": "병원명",
        "FORM_LABEL_2": "원장님 성함",
        "FORM_PLACEHOLDER_1": "서울한의원",
        "FORM_PLACEHOLDER_2": "홍길동",
        "FORM_BUTTON": "무료 도입 견적서 받기",
        "FOOTER_TITLE": "IMD Strategic Consulting",
        "FOOTER_SUB": "메디컬 전용 AI 매출 엔진 | 전국 수많은 병의원 도입 완료",
        "TONGUE_TYPES": {
            "pale": {
                "name": "담백설 (창백한 혀)",
                "emoji": "😶",
                "image": "pale_tongue.png",
                "analysis": (
                    "혀 색이 전반적으로 희고 창백해 보입니다. "
                    "기혈(에너지와 혈액)이 전반적으로 부족해진 상태일 가능성이 높습니다. "
                    "쉽게 피로해지고, 손발이 차거나 어지럼증, 집중력 저하가 동반되기 쉽습니다."
                ),
                "symptoms": "만성 피로, 추위를 많이 탐, 식욕 저하, 어지럼, 얼굴이 창백해 보이는 경향",
                "warning": (
                    "단순 피곤함이 아니라, 몸의 에너지 생산 능력이 떨어진 신호일 수 있습니다. "
                    "장기간 방치하면 면역력 저하, 쉽게 감기에 걸리거나 회복이 느려지는 경향으로 이어질 수 있습니다."
                ),
            },
            "tooth": {
                "name": "치흔설 (이 자국이 남는 혀)",
                "emoji": "😬",
                "image": "tooth_tongue.png",
                "analysis": (
                    "혀 옆 가장자리에 이 자국이 선명하게 찍혀 있는 형태입니다. "
                    "비위(소화기)의 기운이 약해져서, 수분과 노폐물을 제대로 끌어올리지 못하고 "
                    "몸에 습(濕)이 정체되어 있는 상태에서 많이 보입니다."
                ),
                "symptoms": "몸이 무겁고 잘 붓는다, 아침에 일어나도 개운하지 않다, 소화가 더딘 편, 오후에 쉽게 처지는 피로감",
                "warning": (
                    "체질적으로 '잘 붓고, 쉽게 피로해지는 몸'으로 굳어지기 쉬운 패턴입니다. "
                    "방치하면 지방·콜레스테롤 대사 문제, 체중 증가, 만성 피로로 연결될 수 있습니다."
                ),
            },
            "yellow": {
                "name": "황태설 (누런 태가 낀 혀)",
                "emoji": "😮‍💨",
                "image": "yellow_tongue.png",
                "analysis": (
                    "혀 위에 누런 태가 두껍게 낀 모습입니다. "
                    "체내에 열(熱)과 독(毒)이 쌓여 있음을 시사하며, "
                    "간·위장에 부담이 누적된 경우 자주 관찰됩니다."
                ),
                "symptoms": "입 냄새, 입이 자주 마름, 속 쓰림, 변비나 딱딱한 변, 얼굴에 뾰루지·트러블이 잘 올라옴",
                "warning": (
                    "과음, 야식, 매운 음식, 불규칙한 식사와 스트레스가 겹쳐서 "
                    "간·위장에 부담이 과하게 쌓인 신호입니다. "
                    "장기간 방치하면 위염, 소화기 질환, 두통·어지럼으로 이어질 수 있습니다."
                ),
            },
            "purple": {
                "name": "자색설 (자줏빛/검붉은 혀)",
                "emoji": "🟣",
                "image": "purple_tongue.png",
                "analysis": (
                    "혀가 전반적으로 자주빛이 돌거나, 검붉게 보이는 상태입니다. "
                    "혈액순환이 원활하지 않고, 어딘가에 울혈(瘀血)이 정체되어 있는 패턴에서 많이 나타납니다."
                ),
                "symptoms": "만성적인 통증(두통, 어깨·목 결림 등), 손발 저림, 차면서도 답답한 느낌, 어두운 색의 생리혈(여성의 경우)",
                "warning": (
                    "스트레스, 오래 앉아 있는 생활, 과로로 인해 혈액순환이 떨어진 신호일 수 있습니다. "
                    "방치하면 만성 통증, 수족냉증, 두통, 혈압 문제 등으로 이어질 가능성이 있습니다."
                ),
            },
        },
    },

    # ==========================================
    # 2. [GS안과] (?client=gs)
    # ==========================================
    "gs": {
        "APP_TITLE": "GS안과 AI 정밀 검안 센터",
        "APP_ICON": "👁️",
        "HEADER_TITLE": "GS안과 AI 정밀 검안 센터",
        "HEADER_SUB": "단순 가격 문의를 '검안 예약'으로 바꾸는 AI 솔루션",
        "HEADER_SMALL": "'라식 얼마예요?' 묻고 나가는 환자를 잡아드립니다. (체험시간: 2분)",
        "INITIAL_MSG": """안녕하세요, 담당자님.

"라식 얼마예요?" 묻고 나가는 환자들... 아깝지 않으십니까?

저희 AI는 가격을 묻기 전에 '눈 상태'를 먼저 묻습니다.

환자가 자신의 눈이 '단순 근시'가 아니라는 걸 알게 되면, 가격이 아니라 '안전한 수술'을 찾게 됩니다.

지금부터 '시력이 떨어진 환자'가 되어 버튼을 눌러보세요.""",
        "TONGUE_GUIDE": "스마트폰을 멀리 두고, 아래 글씨가 어떻게 보이는지 선택해주세요",
        "CTA_TITLE": "이 AI 시스템을 GS안과에 도입하시겠습니까?",
        "CTA_SUB": "야간/주말 문의 자동 응대로 검안 예약률을 높여드립니다",
        "FORM_LABEL_1": "병원명",
        "FORM_LABEL_2": "담당자 성함",
        "FORM_PLACEHOLDER_1": "GS안과",
        "FORM_PLACEHOLDER_2": "김담당",
        "FORM_BUTTON": "무료 도입 견적서 받기",
        "FOOTER_TITLE": "IMD Strategic Consulting",
        "FOOTER_SUB": "메디컬 전용 AI 매출 엔진 | 안과 특화 솔루션",
        "TONGUE_TYPES": {
            "pale": {
                "name": "선명하게 보임 (정상)",
                "emoji": "🎯",
                "image": "clear_vision.png",
                "analysis": (
                    "현재 교정 시력은 양호하나, 각막 두께와 동공 크기에 따라 "
                    "수술 방법이 달라질 수 있습니다. 정밀 검안을 통해 "
                    "스마일라식/라섹/렌즈삽입술 중 최적의 방법을 찾아야 합니다."
                ),
                "symptoms": "일상생활 불편 없음, 안경/렌즈 착용 중, 수술로 편의성 개선 희망",
                "warning": (
                    "시력이 좋아 보여도 '초고도근시'거나 '각막이 얇은 경우' "
                    "일반 라식이 불가능할 수 있습니다. 정밀 검사가 필수입니다."
                ),
            },
            "tooth": {
                "name": "겹쳐 보임 (난시)",
                "emoji": "😵",
                "image": "astigmatism.png",
                "analysis": (
                    "단순 근시가 아닙니다. 고도 난시가 동반되어 있어 "
                    "일반 라식으로는 교정이 어렵습니다. "
                    "스마일라식 프로 또는 렌즈삽입술이 필요합니다."
                ),
                "symptoms": "글자가 두 개로 보임, 눈이 쉽게 피로함, 두통 동반",
                "warning": (
                    "난시를 방치하면 눈의 피로가 누적되고, "
                    "수술 시기를 놓치면 교정 효과가 떨어질 수 있습니다. "
                    "조기 검안이 중요합니다."
                ),
            },
            "yellow": {
                "name": "뿌옇게 보임 (백내장)",
                "emoji": "☁️",
                "image": "cataract.png",
                "analysis": (
                    "수정체 혼탁이 의심됩니다. 단순 노안이 아니라 "
                    "백내장 초기 증상일 수 있습니다. "
                    "다초점 인공수정체 수술로 노안과 백내장을 동시에 해결할 수 있습니다."
                ),
                "symptoms": "전체적으로 안개 낀 듯함, 밝은 곳에서 더 안 보임, 색이 바래 보임",
                "warning": (
                    "백내장은 방치하면 계속 진행됩니다. "
                    "실손보험 적용 여부를 확인하고, 적절한 시기에 수술하는 것이 중요합니다."
                ),
            },
            "purple": {
                "name": "빛 번짐 (야간 시력)",
                "emoji": "✨",
                "image": "glare.png",
                "analysis": (
                    "동공이 크거나 각막이 불규칙합니다. "
                    "야간 운전이 위험할 수 있으며, "
                    "퍼스널 맞춤 수술 설계가 필요합니다."
                ),
                "symptoms": "가로등/헤드라이트 빛이 퍼져 보임, 야간 운전 불편, 눈부심",
                "warning": (
                    "일반 수술을 받으면 빛 번짐이 더 심해질 수 있습니다. "
                    "동공 크기 측정 후 맞춤 수술을 받아야 합니다."
                ),
            },
        },
    },

    # ==========================================
    # 3. [나나성형외과] (?client=nana)
    # ==========================================
    "nana": {
        "APP_TITLE": "나나성형외과 AI 뷰티 컨설턴트",
        "APP_ICON": "✨",
        "HEADER_TITLE": "NANA AI 뷰티 컨설턴트",
        "HEADER_SUB": "원장님이 수술 중일 때도, AI가 환자의 '니즈'를 파악합니다",
        "HEADER_SMALL": "퇴근 후 문의, 놓치면 경쟁 병원으로 갑니다. (체험시간: 2분)",
        "INITIAL_MSG": """안녕하세요, 실장님.

퇴근 후에 들어오는 성형 문의... 놓치면 다 다른 병원으로 갑니다.

AI가 환자의 '워너비 스타일'을 파악하고 내원까지 시키는 과정을 보여드립니다.

지금부터 '성형을 고민하는 환자'가 되어보세요.""",
        "TONGUE_GUIDE": "원장님께 보여드리고 싶은 '워너비 스타일'을 골라주세요",
        "CTA_TITLE": "이 AI 시스템을 나나성형외과에 도입하시겠습니까?",
        "CTA_SUB": "야간/해외 환자 응대 자동화로 상담 전환율을 높여드립니다",
        "FORM_LABEL_1": "병원명",
        "FORM_LABEL_2": "담당자 성함",
        "FORM_PLACEHOLDER_1": "나나성형외과",
        "FORM_PLACEHOLDER_2": "김실장",
        "FORM_BUTTON": "무료 도입 견적서 받기",
        "FOOTER_TITLE": "IMD Strategic Consulting",
        "FOOTER_SUB": "메디컬 전용 AI 매출 엔진 | 성형외과 특화 솔루션",
        "TONGUE_TYPES": {
            "pale": {
                "name": "자연스러움 (Natural)",
                "emoji": "🌿",
                "image": "natural.png",
                "analysis": (
                    "본연의 얼굴 조화를 중시하시는군요. "
                    "'자연유착'이나 '비개방 코성형'으로 개선 가능합니다. "
                    "티 안 나게 예뻐지는 나나의 '내추럴 라인' 레퍼런스를 보여드릴까요?"
                ),
                "symptoms": "티 안 나는 변화 원함, 자연스러운 라인 선호, 과한 성형 거부감",
                "warning": (
                    "자연스러운 결과를 원하신다면 첫 수술 설계가 매우 중요합니다. "
                    "과하게 하면 재수술이 어렵습니다."
                ),
            },
            "tooth": {
                "name": "화려함 (Fancy)",
                "emoji": "💎",
                "image": "fancy.png",
                "analysis": (
                    "확실한 전후 차이를 원하시는군요. "
                    "'세미아웃 라인'과 '직반버선 코' 조합이 베스트입니다. "
                    "화려한 스타일은 재수술 방지를 위해 첫 수술 설계가 매우 중요합니다."
                ),
                "symptoms": "인형 같은 아이돌 라인 원함, 또렷한 이목구비, 드라마틱한 변화 희망",
                "warning": (
                    "화려한 스타일일수록 숙련된 원장님의 기술이 중요합니다. "
                    "재수술 확률을 낮추려면 처음부터 제대로 해야 합니다."
                ),
            },
            "yellow": {
                "name": "자려함 (Mix)",
                "emoji": "✨",
                "image": "mix.png",
                "analysis": (
                    "요즘 트렌드인 '자려한' 스타일입니다. "
                    "나나성형외과가 가장 잘하는 분야입니다. "
                    "'듀얼 트임'을 병행하여 시원하면서도 부담스럽지 않은 눈매를 완성할 수 있습니다."
                ),
                "symptoms": "자연스러움 + 화려함 동시에, 트렌디한 스타일, 연예인 느낌",
                "warning": (
                    "자려한 스타일은 균형이 핵심입니다. "
                    "한쪽으로 치우치면 어색해 보일 수 있어 정밀 상담이 필요합니다."
                ),
            },
            "purple": {
                "name": "글래머러스 (Glam)",
                "emoji": "💋",
                "image": "glam.png",
                "analysis": (
                    "체형 성형을 고려 중이시군요. "
                    "나나의 '멘토 엑스트라' 보형물과 'Full HD 지방흡입'을 추천드립니다. "
                    "촉감과 라인을 동시에 잡는 플랜을 짜드리겠습니다."
                ),
                "symptoms": "볼륨감 있는 스타일 원함, 가슴/힙 성형 관심, 글래머러스한 체형",
                "warning": (
                    "체형 성형은 보형물 선택이 매우 중요합니다. "
                    "싸구려 보형물은 부작용 위험이 있습니다."
                ),
            },
        },
    },
}


# ============================================
# 현재 설정 로드 함수
# ============================================
def get_config():
    """현재 CLIENT_ID에 맞는 설정 반환"""
    return DATA.get(CLIENT_ID, DATA["oriental"])


# 편의를 위한 현재 설정 변수
CFG = get_config()
APP_TITLE = CFG["APP_TITLE"]
APP_ICON = CFG["APP_ICON"]
TONGUE_TYPES = CFG["TONGUE_TYPES"]
